{"version":3,"file":"passwordlessclient.js","sources":["../src/main.js"],"sourcesContent":["ï»¿/**\r\n * A client for the https://passwordless.dev API that allows webdevelopers to add WebAuthn with minimal coding.\r\n *\r\n * @export\r\n * @class PasswordlessClient\r\n */\r\nexport class PasswordlessClient {\r\n    config = {\r\n        apiUrl: \"https://api.passwordless.dev/\",\r\n        apiKey: \"\",\r\n        Origin: location.origin,\r\n        RPID: location.hostname\r\n    }\r\n    constructor(config) {\r\n        this.config = { ...this.config, ...config }\r\n    }\r\n\r\n    /**\r\n    * Returns true if the device has builtin \"platform\" authenticator (Windows Hello/faceid/fingerprint etc)\r\n    */\r\n    static async isEnabledOnDevice() {\r\n        return await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();\r\n    }\r\n\r\n    static isSupportedByBrowser() {\r\n        if (window.PublicKeyCredential === undefined ||\r\n            typeof window.PublicKeyCredential !== \"function\") {\r\n                return false;\r\n            }\r\n\r\n            return true;\r\n    }\r\n\r\n    CheckSupport() {\r\n        if(!PasswordlessClient.isSupportedByBrowser()){\r\n            throw new Error(\"WebAuthn and PublicKeyCredentials are not supported on this browser/device\");\r\n        }\r\n    }\r\n    \r\n\r\n    /**\r\n     * Register a new credential to a user\r\n     *\r\n     * @param {*} token Token generated by your backend and the passwordless api.\r\n     * @memberof PasswordlessClient\r\n     */\r\n    async register(token) {\r\n        this.CheckSupport();\r\n        let options;\r\n        let session;\r\n\r\n        try {\r\n            var { data, sessionId } = await this.registerBegin(token);\r\n            options = data;\r\n            session = sessionId;\r\n\r\n        } catch (e) {\r\n            console.error(\"Failed during register/begin\");\r\n            throw e;\r\n        }\r\n\r\n        // Turn the challenge back into the accepted format of padded base64\r\n        options.challenge = coerceToArrayBuffer(options.challenge);\r\n        // Turn ID into a UInt8Array Buffer for some reason\r\n        options.user.id = coerceToArrayBuffer(options.user.id);\r\n\r\n        options.excludeCredentials = options.excludeCredentials.map((c) => {\r\n            c.id = coerceToArrayBuffer(c.id);\r\n            return c;\r\n        });\r\n\r\n        if (options.authenticatorSelection.authenticatorAttachment === null) options.authenticatorSelection.authenticatorAttachment = undefined;\r\n\r\n        let newCredential;\r\n        try {\r\n            newCredential = await navigator.credentials.create({\r\n                publicKey: options\r\n            });\r\n        } catch (e) {\r\n            // todo friendlier and more helpful error detection\r\n            var msg = \"Failed during credentials.create in browser. One reason could be because the username is already registered with your authenticator. Please change username or authenticator.\"\r\n            console.warn(msg, e);\r\n            throw e;\r\n        }\r\n\r\n        try {\r\n            await this.registerComplete(newCredential, session);\r\n        } catch (e) {\r\n            console.warn(\"Failed during register/complete\", e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Internal function\r\n     */\r\n    async registerBegin(token) {\r\n        const response = await fetch(this.config.apiUrl + 'register/begin', {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                token: token,\r\n                ...this._params()\r\n            }),\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                \"Content-Type\": \"application/json\",\r\n                'ApiKey': this.config.apiKey\r\n            }\r\n        });\r\n\r\n        let data = await response.json();\r\n\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Internal function\r\n     */\r\n    async registerComplete(newCredential, sessionId) {\r\n        \r\n        // Move data into Arrays incase it is super long\r\n        let attestationObject = new Uint8Array(newCredential.response.attestationObject);\r\n        let clientDataJSON = new Uint8Array(newCredential.response.clientDataJSON);\r\n        let rawId = new Uint8Array(newCredential.rawId);\r\n\r\n        const data = {\r\n            id: newCredential.id,\r\n            rawId: coerceToBase64Url(rawId),\r\n            type: newCredential.type,\r\n            extensions: newCredential.getClientExtensionResults(),\r\n            response: {\r\n                AttestationObject: coerceToBase64Url(attestationObject),\r\n                clientDataJson: coerceToBase64Url(clientDataJSON)\r\n            }\r\n        };\r\n\r\n        const response = await fetch(this.config.apiUrl + 'register/complete', {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                response: data,\r\n                sessionId, sessionId,\r\n                ...this._params()\r\n            }),\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                \"Content-Type\": \"application/json\",\r\n                'ApiKey': this.config.apiKey\r\n            }\r\n        });\r\n\r\n        return await response.json();\r\n    }\r\n\r\n    /**\r\n     * Sign in a user\r\n     *\r\n     * @param {*} username\r\n     * @returns\r\n     * @memberof PasswordlessClient\r\n     */\r\n    async signin(username) {\r\n        this.CheckSupport();\r\n        var options, sessionId;\r\n        try {\r\n            ({ data: options, sessionId } = await this.signinBegin(username));\r\n        } catch (e) {\r\n            console.warn(\"Failed during signin/begin\", e);\r\n            throw e;\r\n        }\r\n\r\n        options.challenge = coerceToArrayBuffer(options.challenge); //const challenge = makeAssertionOptions.challenge.replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n\r\n        options.allowCredentials.forEach(function (listItem) {\r\n            listItem.id = coerceToArrayBuffer(listItem.id);\r\n        });\r\n\r\n        let credential;\r\n        try {\r\n            credential = await navigator.credentials.get({ publicKey: options })\r\n        } catch (e) {\r\n            console.warn(\"Failed during credentials.get in browser.\", e);\r\n            throw e;\r\n        }\r\n\r\n        try {\r\n            let response = await this.signinComplete(credential, sessionId);\r\n            return response.data;\r\n        } catch (e) {\r\n            console.warn(\"Failed during signin/complete\", e);\r\n            throw e;\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Internal function\r\n     */\r\n    async signinBegin(username) {\r\n        var res = await fetch(this.config.apiUrl + \"signin/begin\", {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                username: username,\r\n                ...this._params(),\r\n            }),\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'ApiKey': this.config.apiKey\r\n            }\r\n        });\r\n\r\n        return await res.json();\r\n    }\r\n\r\n    /**\r\n     * Internal function\r\n     */\r\n    async signinComplete(credential, sessionId) {\r\n\r\n        // Move data into Arrays incase it is super long\r\n        let authData = new Uint8Array(credential.response.authenticatorData);\r\n        let clientDataJSON = new Uint8Array(credential.response.clientDataJSON);\r\n        let rawId = new Uint8Array(credential.rawId);\r\n        let sig = new Uint8Array(credential.response.signature);\r\n        \r\n        const data = {\r\n            id: credential.id,\r\n            rawId: coerceToBase64Url(rawId),\r\n            type: credential.type,\r\n            extensions: credential.getClientExtensionResults(),\r\n            response: {\r\n                authenticatorData: coerceToBase64Url(authData),\r\n                clientDataJson: coerceToBase64Url(clientDataJSON),\r\n                signature: coerceToBase64Url(sig)\r\n            }\r\n        };\r\n\r\n        var res = await fetch(this.config.apiUrl + \"signin/complete\", {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                response: data,\r\n                sessionId: sessionId,\r\n                ...this._params(),\r\n            }),\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'ApiKey': this.config.apiKey\r\n            }\r\n        });\r\n\r\n        return await res.json();\r\n    }\r\n\r\n    /**\r\n     * Internal function\r\n     */\r\n    _params() {\r\n        return {\r\n            RPID: this.config.RPID,\r\n            Origin: this.config.Origin\r\n        }\r\n    }    \r\n}\r\n\r\ncoerceToArrayBuffer = function (thing) {\r\n    if (typeof thing === \"string\") {\r\n        // base64url to base64\r\n        thing = thing.replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n\r\n        // base64 to Uint8Array\r\n        var str = window.atob(thing);\r\n        var bytes = new Uint8Array(str.length);\r\n        for (var i = 0; i < str.length; i++) {\r\n            bytes[i] = str.charCodeAt(i);\r\n        }\r\n        thing = bytes;\r\n    }\r\n\r\n    // Array to Uint8Array\r\n    if (Array.isArray(thing)) {\r\n        thing = new Uint8Array(thing);\r\n    }\r\n\r\n    // Uint8Array to ArrayBuffer\r\n    if (thing instanceof Uint8Array) {\r\n        thing = thing.buffer;\r\n    }\r\n\r\n    // error if none of the above worked\r\n    if (!(thing instanceof ArrayBuffer)) {\r\n        throw new TypeError(\"could not coerce to ArrayBuffer\");\r\n    }\r\n\r\n    return thing;\r\n};\r\n\r\n\r\ncoerceToBase64Url = function (thing) {\r\n    // Array or ArrayBuffer to Uint8Array\r\n    if (Array.isArray(thing)) {\r\n        thing = Uint8Array.from(thing);\r\n    }\r\n\r\n    if (thing instanceof ArrayBuffer) {\r\n        thing = new Uint8Array(thing);\r\n    }\r\n\r\n    // Uint8Array to base64\r\n    if (thing instanceof Uint8Array) {\r\n        var str = \"\";\r\n        var len = thing.byteLength;\r\n\r\n        for (var i = 0; i < len; i++) {\r\n            str += String.fromCharCode(thing[i]);\r\n        }\r\n        thing = window.btoa(str);\r\n    }\r\n\r\n    if (typeof thing !== \"string\") {\r\n        throw new Error(\"could not coerce to string\");\r\n    }\r\n\r\n    // base64 to base64url\r\n    // NOTE: \"=\" at the end of challenge is optional, strip it off here\r\n    thing = thing.replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=*$/g, \"\");\r\n\r\n    return thing;\r\n};"],"names":[],"mappings":"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"}