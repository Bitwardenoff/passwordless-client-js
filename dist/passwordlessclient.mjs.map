{"version":3,"file":"passwordlessclient.mjs","sources":["../src/main.js"],"sourcesContent":["ï»¿/**\r\n * A client for the https://passwordless.dev API that allows webdevelopers to add WebAuthn with minimal coding.\r\n *\r\n * @export\r\n * @class PasswordlessClient\r\n */\r\nexport class PasswordlessClient {\r\n    config = {\r\n        apiUrl: \"https://api.passwordless.dev/\",\r\n        apiKey: \"\",\r\n        Origin: location.origin,\r\n        RPID: location.hostname\r\n    }\r\n    constructor(config) {\r\n        this.config = { ...this.config, ...config }\r\n    }\r\n\r\n    /**\r\n    * Returns true if the device has builtin \"platform\" authenticator (Windows Hello/faceid/fingerprint etc)\r\n    */\r\n    static async isEnabledOnDevice() {\r\n        return await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();\r\n    }\r\n\r\n    static isSupportedByBrowser() {\r\n        if (window.PublicKeyCredential === undefined ||\r\n            typeof window.PublicKeyCredential !== \"function\") {\r\n                return false;\r\n            }\r\n\r\n            return true;\r\n    }\r\n\r\n    CheckSupport() {\r\n        if(!PasswordlessClient.isSupportedByBrowser()){\r\n            throw new Error(\"WebAuthn and PublicKeyCredentials are not supported on this browser/device\");\r\n        }\r\n    }\r\n    \r\n\r\n    /**\r\n     * Register a new credential to a user\r\n     *\r\n     * @param {*} token Token generated by your backend and the passwordless api.\r\n     * @memberof PasswordlessClient\r\n     */\r\n    async register(token) {\r\n        this.CheckSupport();\r\n        let options;\r\n        let session;\r\n\r\n        try {\r\n            var { data, sessionId } = await this.registerBegin(token);\r\n            options = data;\r\n            session = sessionId;\r\n\r\n        } catch (e) {\r\n            console.error(\"Failed during register/begin\");\r\n            throw e;\r\n        }\r\n\r\n        // Turn the challenge back into the accepted format of padded base64\r\n        options.challenge = coerceToArrayBuffer(options.challenge);\r\n        // Turn ID into a UInt8Array Buffer for some reason\r\n        options.user.id = coerceToArrayBuffer(options.user.id);\r\n\r\n        options.excludeCredentials = options.excludeCredentials.map((c) => {\r\n            c.id = coerceToArrayBuffer(c.id);\r\n            return c;\r\n        });\r\n\r\n        if (options.authenticatorSelection.authenticatorAttachment === null) options.authenticatorSelection.authenticatorAttachment = undefined;\r\n\r\n        let newCredential;\r\n        try {\r\n            newCredential = await navigator.credentials.create({\r\n                publicKey: options\r\n            });\r\n        } catch (e) {\r\n            // todo friendlier and more helpful error detection\r\n            var msg = \"Failed during credentials.create in browser. One reason could be because the username is already registered with your authenticator. Please change username or authenticator.\"\r\n            console.warn(msg, e);\r\n            throw e;\r\n        }\r\n\r\n        try {\r\n            await this.registerComplete(newCredential, session);\r\n        } catch (e) {\r\n            console.warn(\"Failed during register/complete\", e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Internal function\r\n     */\r\n    async registerBegin(token) {\r\n        const response = await fetch(this.config.apiUrl + 'register/begin', {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                token: token,\r\n                ...this._params()\r\n            }),\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                \"Content-Type\": \"application/json\",\r\n                'ApiKey': this.config.apiKey\r\n            }\r\n        });\r\n\r\n        let data = await response.json();\r\n\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Internal function\r\n     */\r\n    async registerComplete(newCredential, sessionId) {\r\n        \r\n        // Move data into Arrays incase it is super long\r\n        let attestationObject = new Uint8Array(newCredential.response.attestationObject);\r\n        let clientDataJSON = new Uint8Array(newCredential.response.clientDataJSON);\r\n        let rawId = new Uint8Array(newCredential.rawId);\r\n\r\n        const data = {\r\n            id: newCredential.id,\r\n            rawId: coerceToBase64Url(rawId),\r\n            type: newCredential.type,\r\n            extensions: newCredential.getClientExtensionResults(),\r\n            response: {\r\n                AttestationObject: coerceToBase64Url(attestationObject),\r\n                clientDataJson: coerceToBase64Url(clientDataJSON)\r\n            }\r\n        };\r\n\r\n        const response = await fetch(this.config.apiUrl + 'register/complete', {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                response: data,\r\n                sessionId, sessionId,\r\n                ...this._params()\r\n            }),\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                \"Content-Type\": \"application/json\",\r\n                'ApiKey': this.config.apiKey\r\n            }\r\n        });\r\n\r\n        return await response.json();\r\n    }\r\n\r\n    /**\r\n     * Sign in a user\r\n     *\r\n     * @param {*} username\r\n     * @returns\r\n     * @memberof PasswordlessClient\r\n     */\r\n    async signin(username) {\r\n        this.CheckSupport();\r\n        var options, sessionId;\r\n        try {\r\n            ({ data: options, sessionId } = await this.signinBegin(username));\r\n        } catch (e) {\r\n            console.warn(\"Failed during signin/begin\", e);\r\n            throw e;\r\n        }\r\n\r\n        options.challenge = coerceToArrayBuffer(options.challenge); //const challenge = makeAssertionOptions.challenge.replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n\r\n        options.allowCredentials.forEach(function (listItem) {\r\n            listItem.id = coerceToArrayBuffer(listItem.id);\r\n        });\r\n\r\n        let credential;\r\n        try {\r\n            credential = await navigator.credentials.get({ publicKey: options })\r\n        } catch (e) {\r\n            console.warn(\"Failed during credentials.get in browser.\", e);\r\n            throw e;\r\n        }\r\n\r\n        try {\r\n            let response = await this.signinComplete(credential, sessionId);\r\n            return response.data;\r\n        } catch (e) {\r\n            console.warn(\"Failed during signin/complete\", e);\r\n            throw e;\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Internal function\r\n     */\r\n    async signinBegin(username) {\r\n        var res = await fetch(this.config.apiUrl + \"signin/begin\", {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                username: username,\r\n                ...this._params(),\r\n            }),\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'ApiKey': this.config.apiKey\r\n            }\r\n        });\r\n\r\n        return await res.json();\r\n    }\r\n\r\n    /**\r\n     * Internal function\r\n     */\r\n    async signinComplete(credential, sessionId) {\r\n\r\n        // Move data into Arrays incase it is super long\r\n        let authData = new Uint8Array(credential.response.authenticatorData);\r\n        let clientDataJSON = new Uint8Array(credential.response.clientDataJSON);\r\n        let rawId = new Uint8Array(credential.rawId);\r\n        let sig = new Uint8Array(credential.response.signature);\r\n        \r\n        const data = {\r\n            id: credential.id,\r\n            rawId: coerceToBase64Url(rawId),\r\n            type: credential.type,\r\n            extensions: credential.getClientExtensionResults(),\r\n            response: {\r\n                authenticatorData: coerceToBase64Url(authData),\r\n                clientDataJson: coerceToBase64Url(clientDataJSON),\r\n                signature: coerceToBase64Url(sig)\r\n            }\r\n        };\r\n\r\n        var res = await fetch(this.config.apiUrl + \"signin/complete\", {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n                response: data,\r\n                sessionId: sessionId,\r\n                ...this._params(),\r\n            }),\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'ApiKey': this.config.apiKey\r\n            }\r\n        });\r\n\r\n        return await res.json();\r\n    }\r\n\r\n    /**\r\n     * Internal function\r\n     */\r\n    _params() {\r\n        return {\r\n            RPID: this.config.RPID,\r\n            Origin: this.config.Origin\r\n        }\r\n    }    \r\n}\r\n\r\ncoerceToArrayBuffer = function (thing) {\r\n    if (typeof thing === \"string\") {\r\n        // base64url to base64\r\n        thing = thing.replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n\r\n        // base64 to Uint8Array\r\n        var str = window.atob(thing);\r\n        var bytes = new Uint8Array(str.length);\r\n        for (var i = 0; i < str.length; i++) {\r\n            bytes[i] = str.charCodeAt(i);\r\n        }\r\n        thing = bytes;\r\n    }\r\n\r\n    // Array to Uint8Array\r\n    if (Array.isArray(thing)) {\r\n        thing = new Uint8Array(thing);\r\n    }\r\n\r\n    // Uint8Array to ArrayBuffer\r\n    if (thing instanceof Uint8Array) {\r\n        thing = thing.buffer;\r\n    }\r\n\r\n    // error if none of the above worked\r\n    if (!(thing instanceof ArrayBuffer)) {\r\n        throw new TypeError(\"could not coerce to ArrayBuffer\");\r\n    }\r\n\r\n    return thing;\r\n};\r\n\r\n\r\ncoerceToBase64Url = function (thing) {\r\n    // Array or ArrayBuffer to Uint8Array\r\n    if (Array.isArray(thing)) {\r\n        thing = Uint8Array.from(thing);\r\n    }\r\n\r\n    if (thing instanceof ArrayBuffer) {\r\n        thing = new Uint8Array(thing);\r\n    }\r\n\r\n    // Uint8Array to base64\r\n    if (thing instanceof Uint8Array) {\r\n        var str = \"\";\r\n        var len = thing.byteLength;\r\n\r\n        for (var i = 0; i < len; i++) {\r\n            str += String.fromCharCode(thing[i]);\r\n        }\r\n        thing = window.btoa(str);\r\n    }\r\n\r\n    if (typeof thing !== \"string\") {\r\n        throw new Error(\"could not coerce to string\");\r\n    }\r\n\r\n    // base64 to base64url\r\n    // NOTE: \"=\" at the end of challenge is optional, strip it off here\r\n    thing = thing.replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=*$/g, \"\");\r\n\r\n    return thing;\r\n};"],"names":[],"mappings":"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"}